# Markdown to vue

通过编写md文件，转为成vue组件，在由vue转换为html页面。

要达到这个效果，分为两步

1. 将 .md -> .vue字符串
2. 通过 plugin-vue插件 将 .vue字符串 渲染成vue组件


## 认识 .md 文件
在默认配置下```@vitejs/plugin-vue```插件只认识 .vue 文件，根本不会处理其他格式的文件，例如：

```ts
// router/index.ts

import { createWebHistory, createRouter } from "vue-router";
import Home from "../home.vue";

const router = createRouter({
  history: createWebHistory(),
  routes: [
    {
      path: "/",
      component: Home,
    },
    {
      path: "/about",
      component: () => import("../about.md"),
    },
  ],
});

export default router;
```

添加about的路由时，这是vite会出现错误，无法解析```about.md```文件

这时就需要先让```@vitejs/plugin-vue```插件认识 .md 文件，只需要在使用插件时增加对md文件正则即可

```ts
//vite.config.ts

import { defineConfig } from "vite";
import vue from "@vitejs/plugin-vue";

export default defineConfig({
  base: '/',
  plugins: [
    vue({ include: [/\.vue$/, /\.md$/] }),
  ],
});
```
是不是很简单！

到这一步已经可以正确识别 .md 文件了，但是 .md 文件中的内容还只是markdown的格式，还并不是 Vue SFC格式，还不能当成vue文件来渲染。

我们下一步就是要将 .md 文件中是markdown格式的文本转换为html，然后在转成我们熟知的template、script、style 三等一的 Vue格式。

最后通过```@vitejs/plugin-vue```插件将其渲染。

示例效果：

```ts
// about.md

// 原文件内容
# hello world


// 通过插件转换后内容
<template>
  <h1>hello world</h1>
</template>
```

通过插件转换，about.md文件内容从**markdown格式的文本**变为**vue格式的文本**，然后``` @vitejs/plugin-vue```插件识别about.md文件，再将其渲染

通过上述对逻辑的整理，相信你已经明白个七七八八了。下一步就是写出一个将```md -> vue```转换的插件


## Vite-plugin-vue-markdown

> 市面上已经有相同功能的插件[vite-plugin-markdown](https://www.npmjs.com/package/vite-plugin-markdown)、[vite-plugin-md](https://www.npmjs.com/package/vite-plugin-md)、[vue3-sfc-loader](https://github.com/FranckFreiburger/vue3-sfc-loader)。这里不做过多讨论。只是想自己造个轮子，练练手，也方便自定义功能和写法


写插件的第一要素，就是看一看文档，如何创建插件呐~ 

官方文档：[插件API](https://vitejs.cn/vite3-cn/guide/api-plugin.html)

通过文档得知，我们可以通过```transform```、```handleHotUpdate```两个钩子来做文件的转换和热更新后的转换。

准备工作都做完了，现在撸起袖子开干！

1. markdown-it 将markdown转html
2. markdown-it-container 新增```:::demo```md语法，获取该语法块中的vue字符串代码
3. @vue/compiler-sfc 将```:::demo```语法块中的vue字符串代码转为可执行的vue组件
